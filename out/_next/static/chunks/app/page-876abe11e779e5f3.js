(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1503:(e,t,s)=>{Promise.resolve().then(s.bind(s,9506))},9506:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eS});var a=s(5155),n=s(2115),r=s(5339),i=s(2318),l=s(4186),o=s(7434),d=s(4616),c=s(7924),u=s(3717),h=s(2657),x=s(9708),m=s(2085),g=s(2596),p=s(9688);function v(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,p.QP)((0,g.$)(t))}let f=(0,m.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function b(e){let{className:t,variant:s,size:n,asChild:r=!1,...i}=e,l=r?x.DX:"button";return(0,a.jsx)(l,{"data-slot":"button",className:v(f({variant:s,size:n,className:t})),...i})}function j(e){let{className:t,type:s,...n}=e;return(0,a.jsx)("input",{type:s,"data-slot":"input",className:v("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}function w(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:v("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function y(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:v("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function N(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:v("leading-none font-semibold",t),...s})}function k(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:v("text-muted-foreground text-sm",t),...s})}function C(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:v("px-6",t),...s})}function L(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:v("w-full caption-bottom text-sm",t),...s})})}function S(e){let{className:t,...s}=e;return(0,a.jsx)("thead",{"data-slot":"table-header",className:v("[&_tr]:border-b",t),...s})}function z(e){let{className:t,...s}=e;return(0,a.jsx)("tbody",{"data-slot":"table-body",className:v("[&_tr:last-child]:border-0",t),...s})}function F(e){let{className:t,...s}=e;return(0,a.jsx)("tr",{"data-slot":"table-row",className:v("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function I(e){let{className:t,...s}=e;return(0,a.jsx)("th",{"data-slot":"table-head",className:v("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function _(e){let{className:t,...s}=e;return(0,a.jsx)("td",{"data-slot":"table-cell",className:v("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}let A=(0,m.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function P(e){let{className:t,variant:s,asChild:n=!1,...r}=e,i=n?x.DX:"span";return(0,a.jsx)(i,{"data-slot":"badge",className:v(A({variant:s}),t),...r})}var E=s(5452),M=s(4416);function U(e){let{...t}=e;return(0,a.jsx)(E.bL,{"data-slot":"dialog",...t})}function D(e){let{...t}=e;return(0,a.jsx)(E.l9,{"data-slot":"dialog-trigger",...t})}function T(e){let{...t}=e;return(0,a.jsx)(E.ZL,{"data-slot":"dialog-portal",...t})}function R(e){let{className:t,...s}=e;return(0,a.jsx)(E.hJ,{"data-slot":"dialog-overlay",className:v("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function K(e){let{className:t,children:s,showCloseButton:n=!0,...r}=e;return(0,a.jsxs)(T,{"data-slot":"dialog-portal",children:[(0,a.jsx)(R,{}),(0,a.jsxs)(E.UC,{"data-slot":"dialog-content",className:v("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r,children:[s,n&&(0,a.jsxs)(E.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(M.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function q(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:v("flex flex-col gap-2 text-center sm:text-left",t),...s})}function V(e){let{className:t,...s}=e;return(0,a.jsx)(E.hE,{"data-slot":"dialog-title",className:v("text-lg leading-none font-semibold",t),...s})}function O(e){let{className:t,...s}=e;return(0,a.jsx)(E.VY,{"data-slot":"dialog-description",className:v("text-muted-foreground text-sm",t),...s})}var Y=s(968);function W(e){let{className:t,...s}=e;return(0,a.jsx)(Y.b,{"data-slot":"label",className:v("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}var $=s(330),J=s(6474),H=s(5196),Q=s(7863);function Z(e){let{...t}=e;return(0,a.jsx)($.bL,{"data-slot":"select",...t})}function X(e){let{...t}=e;return(0,a.jsx)($.WT,{"data-slot":"select-value",...t})}function B(e){let{className:t,size:s="default",children:n,...r}=e;return(0,a.jsxs)($.l9,{"data-slot":"select-trigger","data-size":s,className:v("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r,children:[n,(0,a.jsx)($.In,{asChild:!0,children:(0,a.jsx)(J.A,{className:"size-4 opacity-50"})})]})}function G(e){let{className:t,children:s,position:n="popper",...r}=e;return(0,a.jsx)($.ZL,{children:(0,a.jsxs)($.UC,{"data-slot":"select-content",className:v("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[(0,a.jsx)(et,{}),(0,a.jsx)($.LM,{className:v("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(es,{})]})})}function ee(e){let{className:t,children:s,...n}=e;return(0,a.jsxs)($.q7,{"data-slot":"select-item",className:v("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...n,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)($.VF,{children:(0,a.jsx)(H.A,{className:"size-4"})})}),(0,a.jsx)($.p4,{children:s})]})}function et(e){let{className:t,...s}=e;return(0,a.jsx)($.PP,{"data-slot":"select-scroll-up-button",className:v("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(Q.A,{className:"size-4"})})}function es(e){let{className:t,...s}=e;return(0,a.jsx)($.wn,{"data-slot":"select-scroll-down-button",className:v("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(J.A,{className:"size-4"})})}var ea=s(7489);function en(e){let{className:t,orientation:s="horizontal",decorative:n=!0,...r}=e;return(0,a.jsx)(ea.b,{"data-slot":"separator",decorative:n,orientation:s,className:v("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...r})}let er=(0,m.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function ei(e){let{className:t,variant:s,...n}=e;return(0,a.jsx)("div",{"data-slot":"alert",role:"alert",className:v(er({variant:s}),t),...n})}function el(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"alert-description",className:v("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...s})}var eo=s(2432),ed=s(9613);function ec(e){let{delayDuration:t=0,...s}=e;return(0,a.jsx)(ed.Kq,{"data-slot":"tooltip-provider",delayDuration:t,...s})}let eu=n.createContext(null);function eh(e){let{defaultOpen:t=!0,open:s,onOpenChange:r,className:i,style:l,children:o,...d}=e,c=function(){let[e,t]=n.useState(void 0);return n.useEffect(()=>{let e=window.matchMedia("(max-width: ".concat(767,"px)")),s=()=>{t(window.innerWidth<768)};return e.addEventListener("change",s),t(window.innerWidth<768),()=>e.removeEventListener("change",s)},[]),!!e}(),[u,h]=n.useState(!1),[x,m]=n.useState(t),g=null!=s?s:x,p=n.useCallback(e=>{let t="function"==typeof e?e(g):e;r?r(t):m(t),document.cookie="".concat("sidebar_state","=").concat(t,"; path=/; max-age=").concat(604800)},[r,g]),f=n.useCallback(()=>c?h(e=>!e):p(e=>!e),[c,p,h]);n.useEffect(()=>{let e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),f())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[f]);let b=g?"expanded":"collapsed",j=n.useMemo(()=>({state:b,open:g,setOpen:p,isMobile:c,openMobile:u,setOpenMobile:h,toggleSidebar:f}),[b,g,p,c,u,h,f]);return(0,a.jsx)(eu.Provider,{value:j,children:(0,a.jsx)(ec,{delayDuration:0,children:(0,a.jsx)("div",{"data-slot":"sidebar-wrapper",style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...l},className:v("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",i),...d,children:o})})})}function ex(e){let{className:t,onClick:s,...r}=e,{toggleSidebar:i}=function(){let e=n.useContext(eu);if(!e)throw Error("useSidebar must be used within a SidebarProvider.");return e}();return(0,a.jsxs)(b,{"data-sidebar":"trigger","data-slot":"sidebar-trigger",variant:"ghost",size:"icon",className:v("size-7",t),onClick:e=>{null==s||s(e),i()},...r,children:[(0,a.jsx)(eo.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function em(e){let{className:t,...s}=e;return(0,a.jsx)("main",{"data-slot":"sidebar-inset",className:v("bg-background relative flex w-full flex-1 flex-col","md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2",t),...s})}(0,m.F)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});var eg=s(3915),ep=s(5317);let ev={apiKey:"AIzaSyAAIMu9zdYQUNbWYKVK7q7KtPo9n1WyuVg",authDomain:"hktutoringmanager.firebaseapp.com",projectId:"hktutoringmanager",storageBucket:"hktutoringmanager.firebasestorage.app",messagingSenderId:"431156965683",appId:"1:431156965683:web:d0a5bae7357197bf6bce46"};console.log("Using Firebase project:",ev.projectId);let ef=(0,eg.Dk)().length?(0,eg.Sx)():(0,eg.Wp)(ev),eb=(0,ep.aU)(ef);function ej(e){var t,s,a,n,r,i,l,o,d;let c=e.data();return{id:e.id,name:c.name,email:c.email,signedUpLessons:null!==(s=null!==(t=c.lessonsSignedUp)&&void 0!==t?t:c.signedUpLessons)&&void 0!==s?s:0,costPerLesson:null!==(n=null!==(a=c.lessonRateHKD)&&void 0!==a?a:c.costPerLesson)&&void 0!==n?n:0,completedLessons:null!==(i=null!==(r=c.lessonsCompleted)&&void 0!==r?r:c.completedLessons)&&void 0!==i?i:0,lastInvoiceMonth:null!==(l=c.lastInvoiceMonth)&&void 0!==l?l:"",nextMonthRequest:null!==(o=c.nextMonthRequest)&&void 0!==o?o:0,rolloverLessons:null!==(d=c.rolloverLessons)&&void 0!==d?d:0}}function ew(e){var t,s,a,n;let r=e.data();return{id:e.id,studentId:r.studentId,lessonType:r.lessonType,lessonCost:r.lessonCost,timestamp:"number"==typeof r.timestamp?r.timestamp:null!==(a=null===(s=r.timestamp)||void 0===s?void 0:null===(t=s.toMillis)||void 0===t?void 0:t.call(s))&&void 0!==a?a:Date.now(),classroomId:null!==(n=r.classroomId)&&void 0!==n?n:""}}async function ey(e){var t,s,a,n;await (0,ep.gS)((0,ep.rJ)(eb,"students"),{name:e.name,email:e.email,lessonsSignedUp:e.signedUpLessons,lessonRateHKD:e.costPerLesson,lessonsCompleted:null!==(t=e.completedLessons)&&void 0!==t?t:0,lastInvoiceMonth:null!==(s=e.lastInvoiceMonth)&&void 0!==s?s:"",nextMonthRequest:null!==(a=e.nextMonthRequest)&&void 0!==a?a:0,rolloverLessons:null!==(n=e.rolloverLessons)&&void 0!==n?n:0})}async function eN(e,t){let s={};void 0!==t.name&&(s.name=t.name),void 0!==t.email&&(s.email=t.email),void 0!==t.signedUpLessons&&(s.lessonsSignedUp=t.signedUpLessons),void 0!==t.costPerLesson&&(s.lessonRateHKD=t.costPerLesson),void 0!==t.completedLessons&&(s.lessonsCompleted=t.completedLessons),void 0!==t.lastInvoiceMonth&&(s.lastInvoiceMonth=t.lastInvoiceMonth),void 0!==t.nextMonthRequest&&(s.nextMonthRequest=t.nextMonthRequest),void 0!==t.rolloverLessons&&(s.rolloverLessons=t.rolloverLessons),await (0,ep.mZ)((0,ep.H9)(eb,"students",e),s)}async function ek(e){var t,s;await (0,ep.gS)((0,ep.rJ)(eb,"checkins"),{...e,classroomId:null!==(t=e.classroomId)&&void 0!==t?t:"",timestamp:null!==(s=e.timestamp)&&void 0!==s?s:Date.now()})}var eC=s(6597),eL=s(6118);function eS(){let[e,t]=(0,n.useState)([]),[s,x]=(0,n.useState)([]),[m,g]=(0,n.useState)([]),[p,v]=(0,n.useState)(""),[f,A]=(0,n.useState)(null),[E,M]=(0,n.useState)(null),[T,R]=(0,n.useState)({name:"",email:"",signedUpLessons:0,costPerLesson:0}),[Y,$]=(0,n.useState)({studentId:"",lessonType:"",lessonCost:0}),[J,H]=(0,n.useState)(!0),[Q,et]=(0,n.useState)(null);(0,n.useEffect)(()=>{var e,s;H(!0),et(null);let a=(e=e=>{t(e),H(!1)},(0,ep.aQ)((0,ep.rJ)(eb,"students"),t=>{let s=t.docs.map(ej);console.log("Firestore students:",s),e(s)},e=>{console.error("Error in students subscription:",e)})),n=(s=e=>{x(e)},(0,ep.aQ)((0,ep.rJ)(eb,"checkins"),e=>{s(e.docs.map(ew))},e=>{console.error("Error in checkIns subscription:",e)}));return()=>{a(),n()}},[]),(0,n.useEffect)(()=>{g(e.map(e=>{let t=s.filter(t=>t.studentId===e.id);console.log("Student: ".concat(e.name," (").concat(e.id,")"),t);let a=t.length,n=a*e.costPerLesson;return{...e,completedLessons:a,totalAmountOwed:n}}))},[e,s]);let es=m.filter(e=>!!e.name&&!!e.email&&(e.name.toLowerCase().includes(p.toLowerCase())||e.email.toLowerCase().includes(p.toLowerCase()))),ea=e.length,er=s.filter(e=>{let t=new Date(e.timestamp),s=new Date;return t.getMonth()===s.getMonth()&&t.getFullYear()===s.getFullYear()}).length,eo=m.reduce((e,t)=>e+t.totalAmountOwed,0),ed=e=>{M({...e})},ec=async()=>{if(E)try{await eN(E.id,{name:E.name,email:E.email,signedUpLessons:E.signedUpLessons,costPerLesson:E.costPerLesson}),M(null)}catch(e){et("Failed to update student"),console.error("Error updating student:",e)}},eu=async()=>{try{await ey(T),R({name:"",email:"",signedUpLessons:0,costPerLesson:0})}catch(e){et("Failed to add student"),console.error("Error adding student:",e)}},eg=async()=>{try{await ek({studentId:Y.studentId,lessonType:Y.lessonType,lessonCost:Y.lessonCost}),$({studentId:"",lessonType:"",lessonCost:0})}catch(e){et("Failed to add check-in"),console.error("Error adding check-in:",e)}},ev=e=>{var t;let s=new eC.Ay;s.setFontSize(22),s.setFont("helvetica","bold"),s.text("Invoice",105,20,{align:"center"}),s.setFontSize(14),s.setFont("helvetica","normal");let a=30;s.setFontSize(12),s.setFont("helvetica","bold"),s.text("Student Name:",20,a),s.setFont("helvetica","normal"),s.text(e.name,60,a),a+=8,s.setFont("helvetica","bold"),s.text("Class:",20,a),s.setFont("helvetica","normal"),s.text("English",60,a),a+=8,s.setFont("helvetica","bold"),s.text("Teacher:",20,a),s.setFont("helvetica","normal"),s.text("Ken",60,a);let n=a+15,r=ef(e.id),i=r.map(e=>[e.lessonType||"N/A",new Date(e.timestamp).toLocaleDateString(),"$".concat(e.lessonCost)]);(0,eL.Ay)(s,{startY:n,head:[["Lesson Type","Date","Price"]],body:i,styles:{halign:"center"},headStyles:{fillColor:[240,240,240],textColor:20,fontStyle:"bold"},theme:"grid",margin:{left:20,right:20}});let l=((null===(t=s.lastAutoTable)||void 0===t?void 0:t.finalY)||n+20)+10;s.setFont("helvetica","bold"),s.text("Total Payable:",120,l),s.setFont("helvetica","normal"),s.text("$".concat(r.reduce((e,t)=>e+(t.lessonCost||0),0).toFixed(2)),170,l,{align:"right"}),s.setFontSize(12),s.setFont("helvetica","normal"),s.text("Thank you for your business!",105,l+15,{align:"center"}),s.save("invoice_".concat(e.name.replace(/\s+/g,"_"),".pdf"))},ef=e=>s.filter(t=>t.studentId===e),eS={};e.forEach(e=>{eS[e.id]=e.name});let ez=s.map(e=>({...e,studentName:eS[e.studentId]||null})).filter(e=>e.studentName);return J?(0,a.jsx)(eh,{children:(0,a.jsx)(em,{children:(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"}),(0,a.jsx)("p",{className:"mt-4 text-muted-foreground",children:"Loading dashboard..."})]})})})}):(0,a.jsx)(eh,{children:(0,a.jsx)(em,{children:(0,a.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,a.jsxs)("header",{className:"flex h-16 shrink-0 items-center gap-2 border-b px-4",children:[(0,a.jsx)(ex,{className:"-ml-1"}),(0,a.jsx)(en,{orientation:"vertical",className:"mr-2 h-4"}),(0,a.jsx)("h1",{className:"text-lg font-semibold",children:"Tutoring Center Dashboard"})]}),(0,a.jsxs)("main",{className:"flex-1 space-y-6 p-6",children:[Q&&(0,a.jsxs)(ei,{variant:"destructive",children:[(0,a.jsx)(r.A,{className:"h-4 w-4"}),(0,a.jsx)(el,{children:Q})]}),(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsxs)(w,{children:[(0,a.jsxs)(y,{children:[(0,a.jsx)(N,{children:"All Check-ins (Matched to Students)"}),(0,a.jsx)(k,{children:"Shows all check-ins from the database, matched to student names."})]}),(0,a.jsx)(C,{children:(0,a.jsxs)(L,{children:[(0,a.jsx)(S,{children:(0,a.jsxs)(F,{children:[(0,a.jsx)(I,{children:"Student Name"}),(0,a.jsx)(I,{children:"Date"}),(0,a.jsx)(I,{children:"Subject"})]})}),(0,a.jsx)(z,{children:0===ez.length?(0,a.jsx)(F,{children:(0,a.jsx)(_,{colSpan:3,className:"text-center text-muted-foreground",children:"No check-ins found in the database."})}):ez.map(e=>(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{children:e.studentName}),(0,a.jsx)(_,{children:new Date(e.timestamp).toLocaleDateString()}),(0,a.jsx)(_,{children:e.classroomId||"N/A"})]},e.id))})]})})]})}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)(w,{children:[(0,a.jsxs)(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(N,{className:"text-sm font-medium",children:"Total Students"}),(0,a.jsx)(i.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(C,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:ea})})]}),(0,a.jsxs)(w,{children:[(0,a.jsxs)(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(N,{className:"text-sm font-medium",children:"Check-ins This Month"}),(0,a.jsx)(l.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(C,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:er})})]}),(0,a.jsxs)(w,{children:[(0,a.jsxs)(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(N,{className:"text-sm font-medium",children:"Total Revenue"}),(0,a.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(C,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",eo]})})]})]}),(0,a.jsxs)(w,{children:[(0,a.jsx)(y,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(N,{children:"Students"}),(0,a.jsx)(k,{children:"Manage student information and track lesson progress"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(U,{children:[(0,a.jsx)(D,{asChild:!0,children:(0,a.jsxs)(b,{children:[(0,a.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Add Student"]})}),(0,a.jsxs)(K,{children:[(0,a.jsxs)(q,{children:[(0,a.jsx)(V,{children:"Add New Student"}),(0,a.jsx)(O,{children:"Enter the student's information below."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"name",children:"Name"}),(0,a.jsx)(j,{id:"name",value:T.name,onChange:e=>R(t=>({...t,name:e.target.value}))})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"email",children:"Email"}),(0,a.jsx)(j,{id:"email",type:"email",value:T.email,onChange:e=>R(t=>({...t,email:e.target.value}))})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"lessons",children:"Signed-Up Lessons"}),(0,a.jsx)(j,{id:"lessons",type:"number",value:T.signedUpLessons,onChange:e=>R(t=>({...t,signedUpLessons:parseInt(e.target.value)||0}))})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"cost",children:"Cost Per Lesson"}),(0,a.jsx)(j,{id:"cost",type:"number",value:T.costPerLesson,onChange:e=>R(t=>({...t,costPerLesson:parseInt(e.target.value)||0}))})]})]}),(0,a.jsx)(b,{onClick:eu,children:"Add Student"})]})]}),(0,a.jsxs)(U,{children:[(0,a.jsx)(D,{asChild:!0,children:(0,a.jsxs)(b,{variant:"outline",children:[(0,a.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"Add Check-in"]})}),(0,a.jsxs)(K,{children:[(0,a.jsxs)(q,{children:[(0,a.jsx)(V,{children:"Manual Check-in"}),(0,a.jsx)(O,{children:"Record a lesson check-in for a student."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"student",children:"Student"}),(0,a.jsxs)(Z,{value:Y.studentId,onValueChange:e=>$(t=>({...t,studentId:e})),children:[(0,a.jsx)(B,{children:(0,a.jsx)(X,{placeholder:"Select a student"})}),(0,a.jsx)(G,{children:e.map(e=>(0,a.jsx)(ee,{value:e.id,children:e.name},e.id))})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"lessonType",children:"Lesson Type"}),(0,a.jsx)(j,{id:"lessonType",value:Y.lessonType,onChange:e=>$(t=>({...t,lessonType:e.target.value})),placeholder:"e.g., Math, Science, English"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"lessonCost",children:"Lesson Cost"}),(0,a.jsx)(j,{id:"lessonCost",type:"number",value:Y.lessonCost,onChange:e=>$(t=>({...t,lessonCost:parseInt(e.target.value)||0}))})]})]}),(0,a.jsx)(b,{onClick:eg,children:"Add Check-in"})]})]})]})]})}),(0,a.jsxs)(C,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)(j,{placeholder:"Search by name or email...",value:p,onChange:e=>v(e.target.value),className:"max-w-sm"})]}),(0,a.jsx)("div",{className:"rounded-md border",children:(0,a.jsxs)(L,{children:[(0,a.jsx)(S,{children:(0,a.jsxs)(F,{children:[(0,a.jsx)(I,{children:"Name"}),(0,a.jsx)(I,{children:"Email"}),(0,a.jsx)(I,{children:"Signed-Up Lessons"}),(0,a.jsx)(I,{children:"Completed Lessons"}),(0,a.jsx)(I,{children:"Cost Per Lesson"}),(0,a.jsx)(I,{children:"Total Amount Owed"}),(0,a.jsx)(I,{children:"Actions"})]})}),(0,a.jsx)(z,{children:es.map(e=>(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{className:"font-medium",children:e.name}),(0,a.jsx)(_,{children:e.email}),(0,a.jsx)(_,{children:e.signedUpLessons}),(0,a.jsx)(_,{children:(0,a.jsx)(P,{variant:"secondary",children:e.completedLessons})}),(0,a.jsxs)(_,{children:["$",e.costPerLesson]}),(0,a.jsxs)(_,{className:"font-semibold",children:["$",e.totalAmountOwed]}),(0,a.jsx)(_,{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b,{variant:"outline",size:"sm",onClick:()=>ed(e),children:(0,a.jsx)(u.A,{className:"h-4 w-4"})}),(0,a.jsxs)(U,{children:[(0,a.jsx)(D,{asChild:!0,children:(0,a.jsx)(b,{variant:"outline",size:"sm",onClick:()=>A(e),children:(0,a.jsx)(h.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(K,{className:"max-w-2xl",children:[(0,a.jsxs)(q,{children:[(0,a.jsxs)(V,{children:["Check-ins for ",e.name]}),(0,a.jsx)(O,{children:"View all lesson check-ins for this student."})]}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,a.jsxs)(L,{children:[(0,a.jsx)(S,{children:(0,a.jsxs)(F,{children:[(0,a.jsx)(I,{children:"Date"}),(0,a.jsx)(I,{children:"Subject"})]})}),(0,a.jsx)(z,{children:(()=>{let t=ef(e.id);return 0===t.length?(0,a.jsx)(F,{children:(0,a.jsx)(_,{colSpan:2,className:"text-center text-muted-foreground",children:"No check-ins found for this student."})}):t.map(e=>(0,a.jsxs)(F,{children:[(0,a.jsx)(_,{children:new Date(e.timestamp).toLocaleDateString()}),(0,a.jsx)(_,{children:e.classroomId||"N/A"})]},e.id))})()})]})})]})]}),(0,a.jsxs)(b,{size:"sm",onClick:()=>ev(e),children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-1"}),"Invoice"]})]})})]},e.id))})]})})]})]}),(0,a.jsx)(U,{open:!!E,onOpenChange:()=>M(null),children:(0,a.jsxs)(K,{children:[(0,a.jsxs)(q,{children:[(0,a.jsx)(V,{children:"Edit Student"}),(0,a.jsx)(O,{children:"Update the student's information."})]}),E&&(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"edit-name",children:"Name"}),(0,a.jsx)(j,{id:"edit-name",value:E.name,onChange:e=>M(t=>t?{...t,name:e.target.value}:null)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"edit-email",children:"Email"}),(0,a.jsx)(j,{id:"edit-email",type:"email",value:E.email,onChange:e=>M(t=>t?{...t,email:e.target.value}:null)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"edit-lessons",children:"Signed-Up Lessons"}),(0,a.jsx)(j,{id:"edit-lessons",type:"number",value:E.signedUpLessons,onChange:e=>M(t=>t?{...t,signedUpLessons:parseInt(e.target.value)||0}:null)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(W,{htmlFor:"edit-cost",children:"Cost Per Lesson"}),(0,a.jsx)(j,{id:"edit-cost",type:"number",value:E.costPerLesson,onChange:e=>M(t=>t?{...t,costPerLesson:parseInt(e.target.value)||0}:null)})]})]}),(0,a.jsx)(b,{onClick:ec,children:"Save Changes"})]})})]})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[930,135,850,441,684,358],()=>t(1503)),_N_E=e.O()}]);